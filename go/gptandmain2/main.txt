package main

import (
	"bufio"
	"fmt"
	"gptandmain/traitement"
	"os"
	"strconv"
	"strings"
	"time"
)

func main() {
	// Cr√©er un nouveau graphe
	graph := traitement.NewGraph()

	// Ouvrir le fichier
	file, err := os.Open("minigraph.txt")
	if err != nil {
		fmt.Println("Erreur lors de l'ouverture du fichier :", err)
		return
	}
	defer file.Close()

	// Lire le fichier ligne par ligne
	fileScanner := bufio.NewScanner(file)
	for fileScanner.Scan() {
		line := fileScanner.Text()

		// Ignorer les lignes vides ou les commentaires (lignes qui commencent par "#")
		if strings.HasPrefix(line, "#") || line == "" {
			continue
		}
		nodes := strings.Fields(line) // D√©couper la ligne par espace
		if len(nodes) == 2 {
			// Convertir les cha√Ænes en entiers
			u, err := strconv.Atoi(nodes[0])
			if err != nil {
				fmt.Println("Erreur lors de la conversion de", nodes[0], "en entier:", err)
				continue
			}
			v, err := strconv.Atoi(nodes[1])
			if err != nil {
				fmt.Println("Erreur lors de la conversion de", nodes[1], "en entier:", err)
				continue
			}

			// Ajouter l'ar√™te au graphe
			graph.AddEdge(u, v)
		}
	}

	// V√©rifier si l'il y a eu des erreurs pendant la lecture
	if err := fileScanner.Err(); err != nil {
		fmt.Println("Erreur lors de la lecture du fichier :", err)
	}

	// graph := traitement.NewGraph()
	// graph.AddEdge(1, 2)
	// graph.AddEdge(1, 3)
	// graph.AddEdge(2, 3)
	// graph.AddEdge(4, 5)
	// graph.AddEdge(5, 6)
	// graph.AddEdge(6, 4)

	// fmt.Println("Avant Louvain :")
	// graph.PrintGraph()

	// Temps d'ex√©cution
	start := time.Now()

	// Lancer l'algorithme de Louvain pour d√©tecter les communaut√©s
	graph.Louvain(10)
	---------------------------------------------------
	fmt.Println("Communaut√©s trouv√©es :")
	// Afficher les communaut√©s
	graph.DisplayCommunities()

	// Afficher le temps d'ex√©cution
	üÜóelapsed := time.Since(start)
	fmt.Printf("Temps d'ex√©cution: %s\n", elapsed)
}
